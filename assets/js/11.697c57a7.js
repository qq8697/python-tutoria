(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{363:function(s,t){s.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAicAAAA5CAYAAADtE4sfAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAEnQAABJ0Ad5mH3gAABYvSURBVHhe7Z3pcxVVt4fv38IHq1LqB+uW17K8vuhrgdfScooUSiyHKCpeEQQnVAYVAREcEWdFUBGZBJlVkBkBA6KAgiKCgoCAzGFy3Tw7vZKdTp/kJATT4f4eatU5vXufHvZuev167bU7/2FCCCGEEDlC4kQIIYQQuULiRAghhBC5QuJECCGEELminjgZ8+VqmUwmk8lkslYzRU6EEEIIkSskToQQQgiRKyROhBBCCJErJE6EEEIIkSskToQQQgiRKyROhBBCCJErJE6EEEIIkSskToQQQgiRKyROhBBCCJErJE6EEEIIkSskToQQQgiRKyROhBBCCJErJE6EEEIIkStOizjZuHGjLViwwGbPnl20ff7557Z8+XL766+/kq0IIYQQ4v8jLS5ONmzYEMTJb7/9Zn/++WfRtmvXLtu0aVP4Pcunyl+Ve+yJBfdZ98/LaoxlyoUQIk988skn1q5dO7v77rtt//79SemZycGDB23Pnj3BduzYYcuWLbNFixbZ6NGjbfjw4VZeXm4dOnSwsWPHJr8w+/vvv+2NN96wZ5991rZs2RKWnW3bttnTTz9tV1xxRagTr2sqbJ9+4HP+/Pl266232ocffpistbDvxx9/3H799dekpJpXX33V2rdvb4888ogdOHAgKa2G82ObPXv2tMOHDyelZocOHbJevXqF3/z444/huN9///1Q95prrrE//vgjqdkwa9eutauuuiq02/fff5+UVsP+Hn744bAf2vjkyZPJmuJZv369DR061Lp06VLvvE8nmeJk24GttvvwTvu76l9ToUPpwCNHjiQlxUGj7du3z1atWmWbN29OSpsPIqTP/G5275wba4xliRMh2g48sOCknnvuORs8eLANGTLERowYYV988YX9/vvvdW62OHWir9yDjh49mpSeHnCs119/fXAkzbHYUeGkunXrllmvMcOJ5hWcK04z67iLMfrbhQbbwmFT/tprr9URIPQ1Dp51TXHqWSAy2A7t+s0339i5555rZWVltnfv3rAfhAnrn3rqKTtx4kT4Df1If1I+ZsyYUBZTSJz49i+88MIgAHD8l19+eajLNV6s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"},411:function(s,t,a){"use strict";a.r(t);var n=a(25),e=Object(n.a)({},(function(){var s=this,t=s.$createElement,n=s._self._c||t;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("h1",{attrs:{id:"pop3-接收邮件"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#pop3-接收邮件"}},[s._v("#")]),s._v(" POP3 接收邮件")]),s._v(" "),n("p",[s._v("Python 内置模块 "),n("code",[s._v("poplib")]),s._v("，实现了 POP3 协议，负责收取邮件，"),n("code",[s._v("email")]),s._v(" 负责解析邮件。")]),s._v(" "),n("p",[s._v("POP3 协议收取的不是可直接阅读的邮件，而是邮件的原始文本，这和 SMTP 协议发送邮件是一致的，其发送的也是编码后的文本；使用 email 模块提供的类解析 POP3 收取的文本，使其可阅读。所以，收取邮件共需两步：")]),s._v(" "),n("ol",[n("li",[s._v("用 "),n("code",[s._v("poplib")]),s._v(" 把邮件的原始文本下载到本地；")]),s._v(" "),n("li",[s._v("用 "),n("code",[s._v("email")]),s._v(" 解析原始文本后自定义输出格式。")])]),s._v(" "),n("h2",{attrs:{id:"一、-pop3-下载邮件"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#一、-pop3-下载邮件"}},[s._v("#")]),s._v(" 一、 POP3 下载邮件")]),s._v(" "),n("div",{staticClass:"language-python line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-python"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" email"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("parser "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" Parser\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" poplib\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 邮箱地址, 授权码和POP3服务器地址:")]),s._v("\nemail_addr "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("input")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'From: '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\npassword "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("input")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Password: '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 授权密码")]),s._v("\npop3_server_host  "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("input")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'SMTP server host: '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# pop.163.com 110")]),s._v("\npop3_server_port  "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("input")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'SMTP server port: '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 创建 pop 连接")]),s._v("\npop "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" poplib"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("POP3"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("pop3_server_host"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" pop3_server_port"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 打印请求信息")]),s._v("\npop"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("set_debuglevel"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 发送身份信息:")]),s._v("\npop"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("user"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("email_addr"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 发送密码")]),s._v("\npop"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("pass_"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("password"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 邮件计数和邮箱大小:")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# print('邮件计数: %s. 邮箱大小: %s' % pop.stat())")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 返回邮件列表")]),s._v("\nresp"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" mails"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" octets "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" pop"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("list")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 可以查看返回的列表类似[b'1 13019', b'2 143642']")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("print")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("mails"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 获取最新一封邮件, 注意索引从1开始:")]),s._v("\nindex "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("len")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("mails"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Retrieve 拉取指定编号的 message，并设置状态为已看 返回 (response, ['line', ...], octets)")]),s._v("\nresp"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" lines"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" octets "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" pop"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("retr"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("index"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# lines存储了邮件的原始文本的每一行,字符串拼接获得整个邮件的原始文本:")]),s._v("\nmsg_content "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("b'\\r\\n'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("join"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("lines"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("decode"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'utf-8'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 解析邮件:")]),s._v("\nmsg "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" Parser"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("parsestr"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("msg_content"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("print")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("msg"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 关闭连接: ")]),s._v("\npop"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("quit"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br")])]),n("p",[s._v("打印的与 pop 服务器交互信息如下：")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("*cmd* 'USER xxx'\n*cmd* 'PASS yyy'\n*cmd* 'LIST'\n[b'1 13019', b'2 143642', b'3 143630']\n*cmd* 'RETR 3'\nReceived: from qq.com (unknown [183.3.255.49])\n...\n*cmd* 'QUIT'\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br")])]),n("p",[n("code",[s._v("POP3")]),s._v(" 对象：")]),s._v(" "),n("ol",[n("li",[n("code",[s._v("user()")]),s._v(" 发送 user 信息。")]),s._v(" "),n("li",[n("code",[s._v("pass_()")]),s._v(" 发送授权码。")]),s._v(" "),n("li",[n("code",[s._v("stat()")]),s._v(" 获取邮箱状态，包括邮件计数和邮箱大小。")]),s._v(" "),n("li",[n("code",[s._v("list()")]),s._v(" 请求 message 列表，返回 "),n("code",[s._v("(response, ['mesg_num octets', ...], octets)")]),s._v("。")]),s._v(" "),n("li",[n("code",[s._v("retr()")]),s._v(" 拉取指定编号的 message，并设置已看状态，返回 "),n("code",[s._v("(response, ['line', ...], octets)")]),s._v("。")]),s._v(" "),n("li",[n("code",[s._v("quit()")]),s._v(" 在调用之前，服务器上的邮箱将被锁定。")])]),s._v(" "),n("p",[n("code",[s._v("Parser")]),s._v(" 对象：")]),s._v(" "),n("ol",[n("li",[n("code",[s._v("parsestr()")]),s._v(" 解析string object。")]),s._v(" "),n("li",[n("code",[s._v("parse()")]),s._v(" 解析file-like object。")])]),s._v(" "),n("p",[s._v("登录网页查看邮件，会有如图所示的标志，表示邮件“已被邮件客户端，其他邮箱代收或手机等通过POP3协议收取”。")]),s._v(" "),n("p",[n("img",{attrs:{src:a(363),alt:""}})]),s._v(" "),n("h2",{attrs:{id:"二、-email-解析邮件"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#二、-email-解析邮件"}},[s._v("#")]),s._v(" 二、 email 解析邮件")]),s._v(" "),n("p",[s._v("打印的 "),n("code",[s._v("message")]),s._v(" 对象内容如下，需要从其中解析出邮件内容、主题、发件人和收件人信息：")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('Received: from qq.com (unknown [183.3.255.49])\n...\nFrom: "=?utf-8?B?5q2m5a6P5paMIGhhdmVmdW4gMjAxNSA6LUQ=?=" <zzz@qq.com>\nTo: "=?utf-8?B?eHjnrqHnkIblkZg=?=" <xxx@163.com>\nSubject: =?utf-8?B?5Zue5aSN77yaeHjns7vnu5/mhJ/osKLmgqjnmoQ=?=\n...\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br")])]),n("p",[n("code",[s._v("Parser")]),s._v(" 模块的 "),n("code",[s._v("parsestr")]),s._v(" 方法将邮件解析为 "),n("code",[s._v("message")]),s._v(" 对象，可能是一个 "),n("code",[s._v("MIMEMultipart")]),s._v(" 对象，包含其它 "),n("code",[s._v("message")]),s._v(" 对象，所以需要递归的处理，新增以下解析代码：")]),s._v(" "),n("div",{staticClass:"language-python line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-python"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" email"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("header "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" decode_header\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" email"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("utils "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" parseaddr\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("print_msg")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("msg"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" indent"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" indent "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" header "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'From'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'To'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Subject'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n            value "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" msg"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("get"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("header"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("''")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n            "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" value"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n                "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" header"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Subject'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n                    value "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" decode_str"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("value"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n                "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("else")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n                    hdr"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" addr "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" parseaddr"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("value"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n                    name "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" decode_str"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("hdr"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n                    value "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("u'%s <%s>'")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("%")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("name"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" addr"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n            "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("print")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'%s%s: %s'")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("%")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'  '")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" indent"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" header"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" value"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("msg"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("is_multipart"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        parts "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" msg"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("get_payload"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" part "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("enumerate")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("parts"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n            "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("print")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'%spart %s'")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("%")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'  '")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" indent"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" n "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n            "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("print")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'%s----'")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("%")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'  '")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" indent"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n            print_msg"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("part"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" indent "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("else")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        content_type "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" msg"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("get_content_type"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" content_type"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'text/plain'")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("or")]),s._v(" content_type"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'text/html'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n            content "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" msg"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("get_payload"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("decode"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("True")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n            charset "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" guess_charset"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("msg"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n            "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" charset"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n            \tcontent "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" content"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("decode"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("charset"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n            "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("print")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'%sText: %s'")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("%")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'  '")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" indent"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" content"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("else")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n            "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("print")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'%sAttachment: %s'")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("%")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'  '")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" indent"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" content_type"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br")])]),n("p",[n("code",[s._v("Message")]),s._v(" 对象：")]),s._v(" "),n("ol",[n("li",[n("code",[s._v("is_multipart")]),s._v(" 方法，返回 "),n("code",[s._v("False")]),s._v(" 表示 "),n("code",[s._v("payload")]),s._v(" 是一个 string object，返回 "),n("code",[s._v("True")]),s._v(" 表示 "),n("code",[s._v("message")]),s._v(" 是 "),n("code",[s._v("Message")]),s._v(" 或其子类对象组成的列表。")]),s._v(" "),n("li",[n("code",[s._v("get_payload")]),s._v(" 方法，返回当前 "),n("code",[s._v("payload")]),s._v("，是 Message 或其子类对象组成的列表或者string object。")])]),s._v(" "),n("p",[s._v("主题、发件人和收件人名称需要 "),n("code",[s._v("decode_header")]),s._v(" 解码，新增以下代码：")]),s._v(" "),n("div",{staticClass:"language-python line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-python"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("decode_str")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("s"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    value"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" charset "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" decode_header"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("s"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" charset"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        value "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" value"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("decode"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("charset"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" value\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])]),n("p",[s._v("邮件内容是 "),n("code",[s._v("bytes")]),s._v(" 类型的数据，需要解码为 "),n("code",[s._v("str")]),s._v("，新增以下代码：")]),s._v(" "),n("div",{staticClass:"language-python line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-python"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("guess_charset")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("msg"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    charset "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" msg"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("get_charset"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" charset "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("is")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("None")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        content_type "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" msg"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("get"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Content-Type'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("''")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("lower"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        pos "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" content_type"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("find"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'charset='")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" pos "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n            charset "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" content_type"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("pos "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("strip"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" charset\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br")])]),n("p",[s._v("执行 "),n("code",[s._v("print_msg(msg)")]),s._v(" 解析原始邮件结果如下：")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('From: xx管理员 <xxx@163.com>\nTo:  <xxx@163.com>\nSubject: xx系统感谢您的注册\npart 1\n----\n  part 1\n  ----\n    Text: hello world\n\nsend by xx管理员，这里有一只猫\n  part 2\n  ----\n    Text: <div style="line-height:1.7;color:#000000;font-size:14px;font-family:Arial">\n    \n        <h1>hello world</h1>\n        <p>send by xx管理员，这里有一只猫 <img src="http://n.sinaimg.cn/sinacn/w637h427/20180201/14cd-fyrcsrw4113824.jpg"></p>\n    \n    \n    </div><br><br><span title="neteasefooter"><p>&nbsp;</p></span>\npart 2\n----\n  Attachment: image/jpeg\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br")])]),n("p",[s._v("可以看到解析的这封邮件是一个 "),n("code",[s._v("MIMEMultipart")]),s._v("，包含两部分：第一部分又是一个 "),n("code",[s._v("MIMEMultipart")]),s._v("，第二部分是一个附件。而内嵌的"),n("code",[s._v("MIMEMultipart")]),s._v(" 也包含两部分："),n("code",[s._v("MIMEText")]),s._v(" 纯文本和 "),n("code",[s._v("MIMEText")]),s._v(" HTML文本。")]),s._v(" "),n("h2",{attrs:{id:"参考文档"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#参考文档"}},[s._v("#")]),s._v(" 参考文档")]),s._v(" "),n("ol",[n("li",[s._v("廖雪峰 "),n("a",{attrs:{href:"https://www.liaoxuefeng.com/wiki/1016959663602400/1017800447489504",target:"_blank",rel:"noopener noreferrer"}},[s._v("POP3收取邮件"),n("OutboundLink")],1)]),s._v(" "),n("li",[s._v("官网  "),n("a",{attrs:{href:"https://docs.python.org/3.5/library/poplib.html?highlight=poplib#module-poplib",target:"_blank",rel:"noopener noreferrer"}},[s._v("poplib"),n("OutboundLink")],1),s._v(" |  "),n("a",{attrs:{href:"https://docs.python.org/3.5/library/email.parser.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("email.parser"),n("OutboundLink")],1),s._v(" | "),n("a",{attrs:{href:"https://docs.python.org/3.5/library/email.message.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("email.message"),n("OutboundLink")],1)]),s._v(" "),n("li",[n("a",{attrs:{href:"http://help.163.com/09/1223/14/5R7P3QI100753VB8.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("163免费邮客户端设置的POP3、SMTP、IMAP地址"),n("OutboundLink")],1)])])])}),[],!1,null,null,null);t.default=e.exports}}]);