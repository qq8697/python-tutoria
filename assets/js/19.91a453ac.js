(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{376:function(t,s,a){"use strict";a.r(s);var n=a(25),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"文件操作"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#文件操作"}},[t._v("#")]),t._v(" 文件操作")]),t._v(" "),a("h2",{attrs:{id:"文件操作的-套路"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#文件操作的-套路"}},[t._v("#")]),t._v(" 文件操作的“套路”")]),t._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 打开文件")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("file")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("open")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("file_url"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" mode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 打开文件并返回文件对象")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 读写文件 ")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 读到内存 ")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("while")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("True")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n\ttext "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" f"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("readLine"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 判断是否读到内容")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("not")]),t._v(" text"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("break")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 写入文件 ")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("file")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("write"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 关闭文件")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("file")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("close"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br"),a("span",{staticClass:"line-number"},[t._v("13")]),a("br"),a("span",{staticClass:"line-number"},[t._v("14")]),a("br"),a("span",{staticClass:"line-number"},[t._v("15")]),a("br"),a("span",{staticClass:"line-number"},[t._v("16")]),a("br")])]),a("h2",{attrs:{id:"打开文件的模式"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#打开文件的模式"}},[t._v("#")]),t._v(" 打开文件的模式")]),t._v(" "),a("p",[a("code",[t._v("open")]),t._v(" 函数完整语法格式：")]),t._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[t._v("f "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("open")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("file")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" mode"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'r'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" buffering"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" encoding"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("None")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" errors"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("None")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" \n\tnewline"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("None")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" closefd"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("True")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" opener"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("None")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br")])]),a("p",[t._v("其中，"),a("code",[t._v("mode")]),t._v(" 参数指定文件打开模式：")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("r")]),t._v(" 只读，（默认模式）文件指针在开头，如果文件不存在会抛出异常；")]),t._v(" "),a("li",[a("code",[t._v("w")]),t._v(" 只写，如果文件存在会覆盖，如果文件不存在则创建新文件；")]),t._v(" "),a("li",[a("code",[t._v("a")]),t._v(" 追加，如果文件存在文件指针在文件结尾，如果文件不存在则创建新文件；")]),t._v(" "),a("li",[a("code",[t._v("r+")]),t._v(" 读写，文件指针在开头，如果文件不存在会抛出异常；")]),t._v(" "),a("li",[a("code",[t._v("w+")]),t._v(" 读写，如果文件存在会覆盖，如果文件不存在则创建新文件；")]),t._v(" "),a("li",[a("code",[t._v("a+")]),t._v(" 读写，如果文件存在文件指针在文件结尾，如果文件不存在则创建新文件；")]),t._v(" "),a("li",[a("code",[t._v("b")]),t._v(" 以二进制模式打开。\nps. 频繁的移动文件指针会影响读写效率，实际开发中多以只读、只写、追加来操作文件。")])]),t._v(" "),a("p",[t._v("通常文件以文本模式打开，读写的都是指定编码（"),a("code",[t._v("encoding")]),t._v(" 参数）的字符串，如果 "),a("code",[t._v("mode")]),t._v(" 参数附加 "),a("code",[t._v("b")]),t._v(" 模式，文件会以二进制模式打开，读写字节对象（"),a("code",[t._v("bytes")]),t._v("）。"),a("br"),t._v("\n（文本文件，可以使用文本编辑器查看的文件，如 Python 源文件；二进制文件，如图片、音频、视频等不能使用文本编辑器查看的文件）")]),t._v(" "),a("h2",{attrs:{id:"文件对象的方法"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#文件对象的方法"}},[t._v("#")]),t._v(" 文件对象的方法")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("read(size)")]),t._v(" 读取指定的字符或字节数，如果省略或者为负，一次性读入并返回文件的所有内容，如果文件大，会非常占用内存。")]),t._v(" "),a("li",[a("code",[t._v("readLine()")]),t._v(" 一次读取一行，并把文件指针移动到下一行准备再次读取"),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 直接迭代文件对象，同样可以实现一次读取一行")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" line "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("file")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" \n\t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("print")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("line"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" end "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br")])])]),t._v(" "),a("li",[a("code",[t._v("readlines()")]),t._v(" 读取所有行并返回列表"),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 直接将文件对象作为list的参数，同样可以实现读取所有行并返回列表")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("print")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("list")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("file")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br")])])]),t._v(" "),a("li",[a("code",[t._v("write()")])]),t._v(" "),a("li",[a("code",[t._v("close()")]),t._v(" 关闭文件，执行后会把文件指针移动到文件的末尾，不能再进行读写操作")]),t._v(" "),a("li",[a("code",[t._v("seek(offset, from_what)")]),t._v(" 移动文件指针（文件指针：标记从哪个位置开始读取数据，第一次打开文件时指向文件的开始位置，执行读取方法后会移动到读取内容的末尾。）")]),t._v(" "),a("li",[a("code",[t._v("tell()")])]),t._v(" "),a("li",[a("code",[t._v("flush()")]),t._v(" 把内部缓冲区的数据写入文件")]),t._v(" "),a("li",[a("code",[t._v("fileno()")]),t._v(" 返回文件描述符，用于 "),a("code",[t._v("os")]),t._v(" 模块的 "),a("code",[t._v("read()")]),t._v(" 方法等底层操作上")])]),t._v(" "),a("p",[t._v("小结：")]),t._v(" "),a("ul",[a("li",[t._v("如果文件很小，"),a("code",[t._v("read()")]),t._v(" 一次性读取最方便；")]),t._v(" "),a("li",[t._v("如果不能确定文件大小，反复调用 "),a("code",[t._v("read(size)")]),t._v(" 比较保险；")]),t._v(" "),a("li",[t._v("如果是配置文件，调用 "),a("code",[t._v("readlines()")]),t._v(" 最方便。")])]),t._v(" "),a("h2",{attrs:{id:"with-语句"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#with-语句"}},[t._v("#")]),t._v(" with 语句")]),t._v(" "),a("p",[t._v("文件读写都有可能产生异常，一旦出错，后面的 "),a("code",[t._v("f.close()")]),t._v(" 关闭文件就不会被调用，所以一般使用 "),a("code",[t._v("try...finally...")]),t._v(" 实现无论报错与否都能正常的关闭文件。")]),t._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("try")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  f "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("open")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/path/to/file'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'r'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("print")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("f"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("read"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("finally")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  f"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("close"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br")])]),a("p",[t._v("使用 "),a("code",[t._v("with")]),t._v(" 处理文件操作，它会帮我们自动调用 "),a("code",[t._v("close")]),t._v(" 方法。（>> "),a("a",{attrs:{href:"/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E9%AB%98%E7%BA%A7/%E4%B8%8A%E4%B8%8B%E6%96%87%E7%AE%A1%E7%90%86%E5%99%A8"}},[t._v("上下文管理器")]),t._v("见后续章节）")]),t._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("with")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("open")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/path/to/file'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'r'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" f"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("print")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("f"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("read"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br")])]),a("h2",{attrs:{id:"番内：python-文件和目录常用管理操作"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#番内：python-文件和目录常用管理操作"}},[t._v("#")]),t._v(" 番内：Python 文件和目录常用管理操作")]),t._v(" "),a("p",[t._v("Python 标准库的 "),a("code",[t._v("os")]),t._v(" 模块提供了对文件和目录常用管理操作。")]),t._v(" "),a("p",[t._v("文件操作：")]),t._v(" "),a("ol",[a("li",[a("code",[t._v("os.rename(源文件名, 目标文件名)")])]),t._v(" "),a("li",[a("code",[t._v("os.remove(文件名)")])])]),t._v(" "),a("p",[t._v("目录操作：")]),t._v(" "),a("ol",[a("li",[a("code",[t._v("os.listdir(目录名)")])]),t._v(" "),a("li",[a("code",[t._v("os.mkdir(目录名)")])]),t._v(" "),a("li",[a("code",[t._v("os.rmdir(目录名)")])]),t._v(" "),a("li",[a("code",[t._v("os.getcwd()")])]),t._v(" "),a("li",[a("code",[t._v("os.chdir(目标目录)")])])]),t._v(" "),a("p",[t._v("路径操作：")]),t._v(" "),a("ol",[a("li",[a("code",[t._v("os.path.join()")]),t._v(" 路径拼接，不要使用字符串拼接，使用 "),a("code",[t._v("os.path")]),t._v(" 模块的 "),a("code",[t._v("join")]),t._v(" 方法，可以正确处理不同操作系统的路径分隔符（linux 下 "),a("code",[t._v("part-1/part-2")]),t._v("，window 下 "),a("code",[t._v("part-1\\part-2")]),t._v("）")]),t._v(" "),a("li",[a("code",[t._v("os.path.split()")]),t._v(" 拆分路径")]),t._v(" "),a("li",[a("code",[t._v("os.path.isdir(文件路径)")])])]),t._v(" "),a("h2",{attrs:{id:"参考文档"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#参考文档"}},[t._v("#")]),t._v(" 参考文档")]),t._v(" "),a("ol",[a("li",[t._v("官网 "),a("a",{attrs:{href:"https://docs.python.org/3.5/tutorial/inputoutput.html#reading-and-writing-files",target:"_blank",rel:"noopener noreferrer"}},[t._v("文件操作"),a("OutboundLink")],1),t._v(" | "),a("a",{attrs:{href:"https://docs.python.org/3.5/library/functions.html#open",target:"_blank",rel:"noopener noreferrer"}},[t._v("open() 函数"),a("OutboundLink")],1),t._v(" | "),a("a",{attrs:{href:"https://docs.python.org/3.5/library/os.html#module-os",target:"_blank",rel:"noopener noreferrer"}},[t._v("os 模块"),a("OutboundLink")],1),t._v(" | "),a("a",{attrs:{href:"https://docs.python.org/3.5/reference/compound_stmts.html?highlight=compound_stmts#the-with-statement",target:"_blank",rel:"noopener noreferrer"}},[t._v("with 语句"),a("OutboundLink")],1)])])])}),[],!1,null,null,null);s.default=e.exports}}]);