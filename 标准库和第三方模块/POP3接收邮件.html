<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>POP3 接收邮件 | Python Tutorial | Python 教程</title>
    <meta name="generator" content="VuePress 1.5.2">
    <link rel="icon" href="/favicon.ico">
    <meta name="description" content="python基础 python进阶 函数式编程 面向对象 面向对象高级 python高级应用 标准库 python web 网络爬虫 数据分析 机器学习 人工智能">
    <link rel="preload" href="/assets/css/0.styles.5d7dc79b.css" as="style"><link rel="preload" href="/assets/js/app.7982f4ec.js" as="script"><link rel="preload" href="/assets/js/2.5dc5b073.js" as="script"><link rel="preload" href="/assets/js/11.697c57a7.js" as="script"><link rel="prefetch" href="/assets/js/10.654901ba.js"><link rel="prefetch" href="/assets/js/12.d02015cf.js"><link rel="prefetch" href="/assets/js/13.c16a62ce.js"><link rel="prefetch" href="/assets/js/14.de19a7a9.js"><link rel="prefetch" href="/assets/js/15.9d03d6f9.js"><link rel="prefetch" href="/assets/js/16.9418409b.js"><link rel="prefetch" href="/assets/js/17.4958f8b1.js"><link rel="prefetch" href="/assets/js/18.ee667b78.js"><link rel="prefetch" href="/assets/js/19.91a453ac.js"><link rel="prefetch" href="/assets/js/20.22cba70d.js"><link rel="prefetch" href="/assets/js/21.2f41d179.js"><link rel="prefetch" href="/assets/js/22.0a3b6da0.js"><link rel="prefetch" href="/assets/js/23.622b0455.js"><link rel="prefetch" href="/assets/js/24.7a864e77.js"><link rel="prefetch" href="/assets/js/25.ed0f3e11.js"><link rel="prefetch" href="/assets/js/26.9f090891.js"><link rel="prefetch" href="/assets/js/27.cc2758de.js"><link rel="prefetch" href="/assets/js/28.2d548cd6.js"><link rel="prefetch" href="/assets/js/29.db7ea4f5.js"><link rel="prefetch" href="/assets/js/3.b3e15418.js"><link rel="prefetch" href="/assets/js/30.97d17e6a.js"><link rel="prefetch" href="/assets/js/31.91c61511.js"><link rel="prefetch" href="/assets/js/32.b36028c4.js"><link rel="prefetch" href="/assets/js/33.41d545bd.js"><link rel="prefetch" href="/assets/js/34.2184c568.js"><link rel="prefetch" href="/assets/js/35.b646fa36.js"><link rel="prefetch" href="/assets/js/36.063e2e44.js"><link rel="prefetch" href="/assets/js/37.231692c9.js"><link rel="prefetch" href="/assets/js/38.ee6c3dd9.js"><link rel="prefetch" href="/assets/js/39.8f62b81f.js"><link rel="prefetch" href="/assets/js/4.eb64ed62.js"><link rel="prefetch" href="/assets/js/40.a5e0f043.js"><link rel="prefetch" href="/assets/js/41.32cca7ae.js"><link rel="prefetch" href="/assets/js/42.cb388f2e.js"><link rel="prefetch" href="/assets/js/43.1c4c891a.js"><link rel="prefetch" href="/assets/js/44.01df042d.js"><link rel="prefetch" href="/assets/js/45.213858ad.js"><link rel="prefetch" href="/assets/js/46.7919d9c5.js"><link rel="prefetch" href="/assets/js/47.ceeba6ce.js"><link rel="prefetch" href="/assets/js/48.9e691e9e.js"><link rel="prefetch" href="/assets/js/49.e0129794.js"><link rel="prefetch" href="/assets/js/5.e7a472e3.js"><link rel="prefetch" href="/assets/js/50.829ee76e.js"><link rel="prefetch" href="/assets/js/51.09644ef8.js"><link rel="prefetch" href="/assets/js/52.76616846.js"><link rel="prefetch" href="/assets/js/53.1890f762.js"><link rel="prefetch" href="/assets/js/54.462975c8.js"><link rel="prefetch" href="/assets/js/55.0c16b1f3.js"><link rel="prefetch" href="/assets/js/56.264cfd64.js"><link rel="prefetch" href="/assets/js/57.afc88876.js"><link rel="prefetch" href="/assets/js/58.fa5ea1e9.js"><link rel="prefetch" href="/assets/js/59.39e09b5a.js"><link rel="prefetch" href="/assets/js/6.4a7ee40c.js"><link rel="prefetch" href="/assets/js/60.4810d7a9.js"><link rel="prefetch" href="/assets/js/61.88c19a39.js"><link rel="prefetch" href="/assets/js/62.d57d7d71.js"><link rel="prefetch" href="/assets/js/63.ad544e5a.js"><link rel="prefetch" href="/assets/js/64.dd8a029c.js"><link rel="prefetch" href="/assets/js/65.e844bc83.js"><link rel="prefetch" href="/assets/js/66.0228e563.js"><link rel="prefetch" href="/assets/js/67.c8e3b05b.js"><link rel="prefetch" href="/assets/js/68.22a32741.js"><link rel="prefetch" href="/assets/js/69.1662777a.js"><link rel="prefetch" href="/assets/js/7.ae21527b.js"><link rel="prefetch" href="/assets/js/8.72e0f139.js"><link rel="prefetch" href="/assets/js/9.891adc7f.js">
    <link rel="stylesheet" href="/assets/css/0.styles.5d7dc79b.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Python Tutorial | Python 教程</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="了解更多" class="dropdown-title"><span class="title">了解更多</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          更多教程
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="https://git.wuhongbin.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Git
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-subitem"><a href="https://mysql.wuhongbin.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Mysql
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></li><li class="dropdown-item"><h4>
          更多作品
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="https://blog.wuhongbin.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  我的博客
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-subitem"><a href="https://nav.wuhongbin.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  前端导航
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-subitem"><a href="https://snippet.wuhongbin.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  代码碎片
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-subitem"><a href="https://mark2web.wuhongbin.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  mark2web
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></li></ul></div></div><div class="nav-item"><a href="https://github.com/qq8697/python-tutorial" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="了解更多" class="dropdown-title"><span class="title">了解更多</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          更多教程
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="https://git.wuhongbin.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Git
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-subitem"><a href="https://mysql.wuhongbin.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Mysql
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></li><li class="dropdown-item"><h4>
          更多作品
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="https://blog.wuhongbin.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  我的博客
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-subitem"><a href="https://nav.wuhongbin.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  前端导航
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-subitem"><a href="https://snippet.wuhongbin.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  代码碎片
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-subitem"><a href="https://mark2web.wuhongbin.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  mark2web
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></li></ul></div></div><div class="nav-item"><a href="https://github.com/qq8697/python-tutorial" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>简介与环境搭建</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/简介与环境搭建/简介.html" class="sidebar-link">简介</a></li><li><a href="/简介与环境搭建/环境搭建.html" class="sidebar-link">环境搭建</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Python 基础</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/Python基础/基本概念.html" class="sidebar-link">基本概念</a></li><li><a href="/Python基础/变量和基本数据类型.html" class="sidebar-link">变量和基本数据类型</a></li><li><a href="/Python基础/数据结构.html" class="sidebar-link">数据结构</a></li><li><a href="/Python基础/流程控制.html" class="sidebar-link">流程控制</a></li><li><a href="/Python基础/函数.html" class="sidebar-link">函数</a></li><li><a href="/Python基础/模块和包.html" class="sidebar-link">模块和包</a></li><li><a href="/Python基础/异常处理.html" class="sidebar-link">异常处理</a></li><li><a href="/Python基础/文件操作.html" class="sidebar-link">文件操作</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>面向对象</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/面向对象/封装.html" class="sidebar-link">封装</a></li><li><a href="/面向对象/继承.html" class="sidebar-link">继承</a></li><li><a href="/面向对象/多态.html" class="sidebar-link">多态</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Python 进阶</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/Python进阶/命名空间和变量的作用域.html" class="sidebar-link">命名空间和变量的作用域</a></li><li><a href="/Python进阶/Python特性.html" class="sidebar-link">Python特性</a></li><li><a href="/Python进阶/虚拟环境.html" class="sidebar-link">虚拟环境</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>函数式编程</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/函数式编程/函数式编程概念.html" class="sidebar-link">函数式编程概念</a></li><li><a href="/函数式编程/函数式编程技术.html" class="sidebar-link">函数式编程技术</a></li><li><a href="/函数式编程/装饰器.html" class="sidebar-link">装饰器</a></li><li><a href="/函数式编程/偏函数.html" class="sidebar-link">偏函数</a></li><li><a href="/函数式编程/缓存函数.html" class="sidebar-link">缓存函数</a></li><li><a href="/函数式编程/Python内置高阶函数.html" class="sidebar-link">Python内置高阶函数</a></li><li><a href="/函数式编程/使用itertools构建工具函数.html" class="sidebar-link">使用itertools构建工具函数</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>面向对象高级</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/面向对象高级/再议封装.html" class="sidebar-link">再议封装</a></li><li><a href="/面向对象高级/再议继承.html" class="sidebar-link">再议继承</a></li><li><a href="/面向对象高级/类特殊成员.html" class="sidebar-link">类特殊成员</a></li><li><a href="/面向对象高级/迭代器与生成器.html" class="sidebar-link">迭代器与生成器</a></li><li><a href="/面向对象高级/上下文管理器.html" class="sidebar-link">上下文管理器</a></li><li><a href="/面向对象高级/限制实例的属性.html" class="sidebar-link">限制实例的属性</a></li><li><a href="/面向对象高级/property属性.html" class="sidebar-link">property属性</a></li><li><a href="/面向对象高级/type和元类.html" class="sidebar-link">type和元类</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Python 高级</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/Python高级/正则表达式.html" class="sidebar-link">正则表达式</a></li><li><a href="/Python高级/线程.html" class="sidebar-link">线程</a></li><li><a href="/Python高级/进程.html" class="sidebar-link">进程</a></li><li><a href="/Python高级/协程.html" class="sidebar-link">协程</a></li><li><a href="/Python高级/异步编程.html" class="sidebar-link">异步编程</a></li><li><a href="/Python高级/socket套接字.html" class="sidebar-link">socket套接字</a></li><li><a href="/Python高级/UDP和TCP协议.html" class="sidebar-link">UDP和TCP协议</a></li><li><a href="/Python高级/HTTP协议.html" class="sidebar-link">HTTP协议</a></li><li><a href="/Python高级/数据库.html" class="sidebar-link">数据库</a></li><li><a href="/Python高级/SQL语句.html" class="sidebar-link">SQL语句</a></li><li><a href="/Python高级/MySQL数据库.html" class="sidebar-link">MySQL数据库</a></li><li><a href="/Python高级/pymysql模块.html" class="sidebar-link">pymysql模块</a></li><li><a href="/Python高级/SQLite数据库.html" class="sidebar-link">SQLite数据库</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>标准库和第三方模块</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/标准库和第三方模块/pickle_对象序列化.html" class="sidebar-link">pickle_对象序列化</a></li><li><a href="/标准库和第三方模块/copy_深拷贝和浅拷贝.html" class="sidebar-link">copy_深拷贝和浅拷贝</a></li><li><a href="/标准库和第三方模块/weakref_弱引用.html" class="sidebar-link">weakref_弱引用</a></li><li><a href="/标准库和第三方模块/datetime_日期和时间数据类型.html" class="sidebar-link">datetime_日期和时间数据类型</a></li><li><a href="/标准库和第三方模块/collections_集合数据类型.html" class="sidebar-link">collections_集合数据类型</a></li><li><a href="/标准库和第三方模块/enum_枚举数据类型.html" class="sidebar-link">enum_枚举数据类型</a></li><li><a href="/标准库和第三方模块/logging_日志服务.html" class="sidebar-link">logging_日志服务</a></li><li><a href="/标准库和第三方模块/加密验证服务.html" class="sidebar-link">加密验证服务</a></li><li><a href="/标准库和第三方模块/电子邮件.html" class="sidebar-link">电子邮件</a></li><li><a href="/标准库和第三方模块/SMTP发送邮件.html" class="sidebar-link">SMTP发送邮件</a></li><li><a href="/标准库和第三方模块/POP3接收邮件.html" class="active sidebar-link">POP3接收邮件</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/标准库和第三方模块/POP3接收邮件.html#一、-pop3-下载邮件" class="sidebar-link">一、 POP3 下载邮件</a></li><li class="sidebar-sub-header"><a href="/标准库和第三方模块/POP3接收邮件.html#二、-email-解析邮件" class="sidebar-link">二、 email 解析邮件</a></li><li class="sidebar-sub-header"><a href="/标准库和第三方模块/POP3接收邮件.html#参考文档" class="sidebar-link">参考文档</a></li></ul></li><li><a href="/标准库和第三方模块/结构化数据处理.html" class="sidebar-link">结构化数据处理</a></li><li><a href="/标准库和第三方模块/二进制数据处理.html" class="sidebar-link">二进制数据处理</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Web 开发</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/Web开发/WSGI.html" class="sidebar-link">WSGI</a></li><li><a href="/Web开发/实现简单Web框架.html" class="sidebar-link">实现简单Web框架</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>爬虫与数据分析</span> <!----></p> <!----></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>自动化运维与测试</span> <!----></p> <!----></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>人工智能和机器学习</span> <!----></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="pop3-接收邮件"><a href="#pop3-接收邮件" class="header-anchor">#</a> POP3 接收邮件</h1> <p>Python 内置模块 <code>poplib</code>，实现了 POP3 协议，负责收取邮件，<code>email</code> 负责解析邮件。</p> <p>POP3 协议收取的不是可直接阅读的邮件，而是邮件的原始文本，这和 SMTP 协议发送邮件是一致的，其发送的也是编码后的文本；使用 email 模块提供的类解析 POP3 收取的文本，使其可阅读。所以，收取邮件共需两步：</p> <ol><li>用 <code>poplib</code> 把邮件的原始文本下载到本地；</li> <li>用 <code>email</code> 解析原始文本后自定义输出格式。</li></ol> <h2 id="一、-pop3-下载邮件"><a href="#一、-pop3-下载邮件" class="header-anchor">#</a> 一、 POP3 下载邮件</h2> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">from</span> email<span class="token punctuation">.</span>parser <span class="token keyword">import</span> Parser
<span class="token keyword">import</span> poplib

<span class="token comment"># 邮箱地址, 授权码和POP3服务器地址:</span>
email_addr <span class="token operator">=</span> <span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">'From: '</span><span class="token punctuation">)</span>
password <span class="token operator">=</span> <span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">'Password: '</span><span class="token punctuation">)</span> <span class="token comment"># 授权密码</span>
pop3_server_host  <span class="token operator">=</span> <span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">'SMTP server host: '</span><span class="token punctuation">)</span> <span class="token comment"># pop.163.com 110</span>
pop3_server_port  <span class="token operator">=</span> <span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">'SMTP server port: '</span><span class="token punctuation">)</span>

<span class="token comment"># 创建 pop 连接</span>
pop <span class="token operator">=</span> poplib<span class="token punctuation">.</span>POP3<span class="token punctuation">(</span>pop3_server_host<span class="token punctuation">,</span> pop3_server_port<span class="token punctuation">)</span>
<span class="token comment"># 打印请求信息</span>
pop<span class="token punctuation">.</span>set_debuglevel<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>

<span class="token comment"># 发送身份信息:</span>
pop<span class="token punctuation">.</span>user<span class="token punctuation">(</span>email_addr<span class="token punctuation">)</span>
<span class="token comment"># 发送密码</span>
pop<span class="token punctuation">.</span>pass_<span class="token punctuation">(</span>password<span class="token punctuation">)</span>

<span class="token comment"># 邮件计数和邮箱大小:</span>
<span class="token comment"># print('邮件计数: %s. 邮箱大小: %s' % pop.stat())</span>

<span class="token comment"># 返回邮件列表</span>
resp<span class="token punctuation">,</span> mails<span class="token punctuation">,</span> octets <span class="token operator">=</span> pop<span class="token punctuation">.</span><span class="token builtin">list</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># 可以查看返回的列表类似[b'1 13019', b'2 143642']</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>mails<span class="token punctuation">)</span>

<span class="token comment"># 获取最新一封邮件, 注意索引从1开始:</span>
index <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>mails<span class="token punctuation">)</span>
<span class="token comment"># Retrieve 拉取指定编号的 message，并设置状态为已看 返回 (response, ['line', ...], octets)</span>
resp<span class="token punctuation">,</span> lines<span class="token punctuation">,</span> octets <span class="token operator">=</span> pop<span class="token punctuation">.</span>retr<span class="token punctuation">(</span>index<span class="token punctuation">)</span>

<span class="token comment"># lines存储了邮件的原始文本的每一行,字符串拼接获得整个邮件的原始文本:</span>
msg_content <span class="token operator">=</span> <span class="token string">b'\r\n'</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>lines<span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>

<span class="token comment"># 解析邮件:</span>
msg <span class="token operator">=</span> Parser<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>parsestr<span class="token punctuation">(</span>msg_content<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span>

<span class="token comment"># 关闭连接: </span>
pop<span class="token punctuation">.</span>quit<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br></div></div><p>打印的与 pop 服务器交互信息如下：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>*cmd* 'USER xxx'
*cmd* 'PASS yyy'
*cmd* 'LIST'
[b'1 13019', b'2 143642', b'3 143630']
*cmd* 'RETR 3'
Received: from qq.com (unknown [183.3.255.49])
...
*cmd* 'QUIT'
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p><code>POP3</code> 对象：</p> <ol><li><code>user()</code> 发送 user 信息。</li> <li><code>pass_()</code> 发送授权码。</li> <li><code>stat()</code> 获取邮箱状态，包括邮件计数和邮箱大小。</li> <li><code>list()</code> 请求 message 列表，返回 <code>(response, ['mesg_num octets', ...], octets)</code>。</li> <li><code>retr()</code> 拉取指定编号的 message，并设置已看状态，返回 <code>(response, ['line', ...], octets)</code>。</li> <li><code>quit()</code> 在调用之前，服务器上的邮箱将被锁定。</li></ol> <p><code>Parser</code> 对象：</p> <ol><li><code>parsestr()</code> 解析string object。</li> <li><code>parse()</code> 解析file-like object。</li></ol> <p>登录网页查看邮件，会有如图所示的标志，表示邮件“已被邮件客户端，其他邮箱代收或手机等通过POP3协议收取”。</p> <p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAicAAAA5CAYAAADtE4sfAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAEnQAABJ0Ad5mH3gAABYvSURBVHhe7Z3pcxVVt4fv38IHq1LqB+uW17K8vuhrgdfScooUSiyHKCpeEQQnVAYVAREcEWdFUBGZBJlVkBkBA6KAgiKCgoCAzGFy3Tw7vZKdTp/kJATT4f4eatU5vXufHvZuev167bU7/2FCCCGEEDlC4kQIIYQQuULiRAghhBC5QuJECCGEELminjgZ8+VqmUwmk8lkslYzRU6EEEIIkSskToQQQgiRKyROhBBCCJErJE6EEEIIkSskToQQQgiRKyROhBBCCJErJE6EEEIIkSskToQQQgiRKyROhBBCCJErJE6EEEIIkSskToQQQgiRKyROhBBCCJErJE6EEEIIkStOizjZuHGjLViwwGbPnl20ff7557Z8+XL766+/kq0IIYQQ4v8jLS5ONmzYEMTJb7/9Zn/++WfRtmvXLtu0aVP4Pcunyl+Ve+yJBfdZ98/LaoxlyoUQIk988skn1q5dO7v77rtt//79SemZycGDB23Pnj3BduzYYcuWLbNFixbZ6NGjbfjw4VZeXm4dOnSwsWPHJr8w+/vvv+2NN96wZ5991rZs2RKWnW3bttnTTz9tV1xxRagTr2sqbJ9+4HP+/Pl266232ocffpistbDvxx9/3H799dekpJpXX33V2rdvb4888ogdOHAgKa2G82ObPXv2tMOHDyelZocOHbJevXqF3/z444/huN9///1Q95prrrE//vgjqdkwa9eutauuuiq02/fff5+UVsP+Hn744bAf2vjkyZPJmuJZv369DR061Lp06VLvvE8nmeJk24GttvvwTvu76l9ToUPpwCNHjiQlxUGj7du3z1atWmWbN29OSpsPIqTP/G5275wba4xliRMh2g48sOCknnvuORs8eLANGTLERowYYV988YX9/vvvdW62OHWir9yDjh49mpSeHnCs119/fXAkzbHYUeGkunXrllmvMcOJ5hWcK04z67iLMfrbhQbbwmFT/tprr9URIPQ1Dp51TXHqWSAy2A7t+s0339i5555rZWVltnfv3rAfhAnrn3rqKTtx4kT4Df1If1I+ZsyYUBZTSJz49i+88MIgAHD8l19+eajLNV6s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" alt=""></p> <h2 id="二、-email-解析邮件"><a href="#二、-email-解析邮件" class="header-anchor">#</a> 二、 email 解析邮件</h2> <p>打印的 <code>message</code> 对象内容如下，需要从其中解析出邮件内容、主题、发件人和收件人信息：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>Received: from qq.com (unknown [183.3.255.49])
...
From: &quot;=?utf-8?B?5q2m5a6P5paMIGhhdmVmdW4gMjAxNSA6LUQ=?=&quot; &lt;zzz@qq.com&gt;
To: &quot;=?utf-8?B?eHjnrqHnkIblkZg=?=&quot; &lt;xxx@163.com&gt;
Subject: =?utf-8?B?5Zue5aSN77yaeHjns7vnu5/mhJ/osKLmgqjnmoQ=?=
...
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p><code>Parser</code> 模块的 <code>parsestr</code> 方法将邮件解析为 <code>message</code> 对象，可能是一个 <code>MIMEMultipart</code> 对象，包含其它 <code>message</code> 对象，所以需要递归的处理，新增以下解析代码：</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">from</span> email<span class="token punctuation">.</span>header <span class="token keyword">import</span> decode_header
<span class="token keyword">from</span> email<span class="token punctuation">.</span>utils <span class="token keyword">import</span> parseaddr

<span class="token keyword">def</span> <span class="token function">print_msg</span><span class="token punctuation">(</span>msg<span class="token punctuation">,</span> indent<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> indent <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
        <span class="token keyword">for</span> header <span class="token keyword">in</span> <span class="token punctuation">[</span><span class="token string">'From'</span><span class="token punctuation">,</span> <span class="token string">'To'</span><span class="token punctuation">,</span> <span class="token string">'Subject'</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
            value <span class="token operator">=</span> msg<span class="token punctuation">.</span>get<span class="token punctuation">(</span>header<span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span>
            <span class="token keyword">if</span> value<span class="token punctuation">:</span>
                <span class="token keyword">if</span> header<span class="token operator">==</span><span class="token string">'Subject'</span><span class="token punctuation">:</span>
                    value <span class="token operator">=</span> decode_str<span class="token punctuation">(</span>value<span class="token punctuation">)</span>
                <span class="token keyword">else</span><span class="token punctuation">:</span>
                    hdr<span class="token punctuation">,</span> addr <span class="token operator">=</span> parseaddr<span class="token punctuation">(</span>value<span class="token punctuation">)</span>
                    name <span class="token operator">=</span> decode_str<span class="token punctuation">(</span>hdr<span class="token punctuation">)</span>
                    value <span class="token operator">=</span> <span class="token string">u'%s &lt;%s&gt;'</span> <span class="token operator">%</span> <span class="token punctuation">(</span>name<span class="token punctuation">,</span> addr<span class="token punctuation">)</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'%s%s: %s'</span> <span class="token operator">%</span> <span class="token punctuation">(</span><span class="token string">'  '</span> <span class="token operator">*</span> indent<span class="token punctuation">,</span> header<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>msg<span class="token punctuation">.</span>is_multipart<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        parts <span class="token operator">=</span> msg<span class="token punctuation">.</span>get_payload<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">for</span> n<span class="token punctuation">,</span> part <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>parts<span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'%spart %s'</span> <span class="token operator">%</span> <span class="token punctuation">(</span><span class="token string">'  '</span> <span class="token operator">*</span> indent<span class="token punctuation">,</span> n <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'%s----'</span> <span class="token operator">%</span> <span class="token punctuation">(</span><span class="token string">'  '</span> <span class="token operator">*</span> indent<span class="token punctuation">)</span><span class="token punctuation">)</span>
            print_msg<span class="token punctuation">(</span>part<span class="token punctuation">,</span> indent <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        content_type <span class="token operator">=</span> msg<span class="token punctuation">.</span>get_content_type<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> content_type<span class="token operator">==</span><span class="token string">'text/plain'</span> <span class="token keyword">or</span> content_type<span class="token operator">==</span><span class="token string">'text/html'</span><span class="token punctuation">:</span>
            content <span class="token operator">=</span> msg<span class="token punctuation">.</span>get_payload<span class="token punctuation">(</span>decode<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
            charset <span class="token operator">=</span> guess_charset<span class="token punctuation">(</span>msg<span class="token punctuation">)</span>
            <span class="token keyword">if</span> charset<span class="token punctuation">:</span>
            	content <span class="token operator">=</span> content<span class="token punctuation">.</span>decode<span class="token punctuation">(</span>charset<span class="token punctuation">)</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'%sText: %s'</span> <span class="token operator">%</span> <span class="token punctuation">(</span><span class="token string">'  '</span> <span class="token operator">*</span> indent<span class="token punctuation">,</span> content<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'%sAttachment: %s'</span> <span class="token operator">%</span> <span class="token punctuation">(</span><span class="token string">'  '</span> <span class="token operator">*</span> indent<span class="token punctuation">,</span> content_type<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br></div></div><p><code>Message</code> 对象：</p> <ol><li><code>is_multipart</code> 方法，返回 <code>False</code> 表示 <code>payload</code> 是一个 string object，返回 <code>True</code> 表示 <code>message</code> 是 <code>Message</code> 或其子类对象组成的列表。</li> <li><code>get_payload</code> 方法，返回当前 <code>payload</code>，是 Message 或其子类对象组成的列表或者string object。</li></ol> <p>主题、发件人和收件人名称需要 <code>decode_header</code> 解码，新增以下代码：</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">decode_str</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">:</span>
    value<span class="token punctuation">,</span> charset <span class="token operator">=</span> decode_header<span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
    <span class="token keyword">if</span> charset<span class="token punctuation">:</span>
        value <span class="token operator">=</span> value<span class="token punctuation">.</span>decode<span class="token punctuation">(</span>charset<span class="token punctuation">)</span>
    <span class="token keyword">return</span> value
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>邮件内容是 <code>bytes</code> 类型的数据，需要解码为 <code>str</code>，新增以下代码：</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">guess_charset</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">:</span>
    charset <span class="token operator">=</span> msg<span class="token punctuation">.</span>get_charset<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> charset <span class="token keyword">is</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
        content_type <span class="token operator">=</span> msg<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'Content-Type'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">.</span>lower<span class="token punctuation">(</span><span class="token punctuation">)</span>
        pos <span class="token operator">=</span> content_type<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">'charset='</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> pos <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">:</span>
            charset <span class="token operator">=</span> content_type<span class="token punctuation">[</span>pos <span class="token operator">+</span> <span class="token number">8</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> charset
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>执行 <code>print_msg(msg)</code> 解析原始邮件结果如下：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>From: xx管理员 &lt;xxx@163.com&gt;
To:  &lt;xxx@163.com&gt;
Subject: xx系统感谢您的注册
part 1
----
  part 1
  ----
    Text: hello world

send by xx管理员，这里有一只猫
  part 2
  ----
    Text: &lt;div style=&quot;line-height:1.7;color:#000000;font-size:14px;font-family:Arial&quot;&gt;
    
        &lt;h1&gt;hello world&lt;/h1&gt;
        &lt;p&gt;send by xx管理员，这里有一只猫 &lt;img src=&quot;http://n.sinaimg.cn/sinacn/w637h427/20180201/14cd-fyrcsrw4113824.jpg&quot;&gt;&lt;/p&gt;
    
    
    &lt;/div&gt;&lt;br&gt;&lt;br&gt;&lt;span title=&quot;neteasefooter&quot;&gt;&lt;p&gt;&amp;nbsp;&lt;/p&gt;&lt;/span&gt;
part 2
----
  Attachment: image/jpeg
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><p>可以看到解析的这封邮件是一个 <code>MIMEMultipart</code>，包含两部分：第一部分又是一个 <code>MIMEMultipart</code>，第二部分是一个附件。而内嵌的<code>MIMEMultipart</code> 也包含两部分：<code>MIMEText</code> 纯文本和 <code>MIMEText</code> HTML文本。</p> <h2 id="参考文档"><a href="#参考文档" class="header-anchor">#</a> 参考文档</h2> <ol><li>廖雪峰 <a href="https://www.liaoxuefeng.com/wiki/1016959663602400/1017800447489504" target="_blank" rel="noopener noreferrer">POP3收取邮件<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li>官网  <a href="https://docs.python.org/3.5/library/poplib.html?highlight=poplib#module-poplib" target="_blank" rel="noopener noreferrer">poplib<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> |  <a href="https://docs.python.org/3.5/library/email.parser.html" target="_blank" rel="noopener noreferrer">email.parser<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> | <a href="https://docs.python.org/3.5/library/email.message.html" target="_blank" rel="noopener noreferrer">email.message<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="http://help.163.com/09/1223/14/5R7P3QI100753VB8.html" target="_blank" rel="noopener noreferrer">163免费邮客户端设置的POP3、SMTP、IMAP地址<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ol></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/标准库和第三方模块/SMTP发送邮件.html" class="prev">
        SMTP发送邮件
      </a></span> <span class="next"><a href="/标准库和第三方模块/结构化数据处理.html">
        结构化数据处理
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.7982f4ec.js" defer></script><script src="/assets/js/2.5dc5b073.js" defer></script><script src="/assets/js/11.697c57a7.js" defer></script>
  </body>
</html>
